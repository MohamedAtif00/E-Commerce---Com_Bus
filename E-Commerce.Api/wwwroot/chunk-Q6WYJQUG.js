import{V as m,g as c}from"./chunk-74T7YZYI.js";var o=class{constructor(){this.BasketItems=[]}};var B=(()=>{let i=class i{constructor(){this.basketKey="basketItems",this.cartSubject=new c(this.getInitialBasket()),this.cart$=this.cartSubject.asObservable()}getInitialBasket(){let s=localStorage.getItem(this.basketKey);return s?JSON.parse(s):new o}updateLocalStorage(s){localStorage.setItem(this.basketKey,JSON.stringify(s)),this.cartSubject.next(s)}addItem(s){let t=this.getInitialBasket(),e=t.BasketItems.findIndex(a=>a.ProductId===s.ProductId);e===-1?(s.Total=s.Quantity*s.UnitPrice,t.BasketItems.push(s)):(t.BasketItems[e].Quantity+=s.Quantity,t.BasketItems[e].Total=t.BasketItems[e].Quantity*t.BasketItems[e].UnitPrice),t.totalAmount=this.calculateTotalAmount(t.BasketItems),this.updateLocalStorage(t)}removeOneItem(s){let t=this.getInitialBasket(),e=t.BasketItems.findIndex(a=>a.ProductId===s);e!==-1&&(t.BasketItems[e].Quantity>1?(t.BasketItems[e].Quantity-=1,t.BasketItems[e].Total=t.BasketItems[e].Quantity*t.BasketItems[e].UnitPrice):t.BasketItems.splice(e,1),t.totalAmount=this.calculateTotalAmount(t.BasketItems),this.updateLocalStorage(t))}setItemQuantity(s,t){let e=this.getInitialBasket(),a=e.BasketItems.findIndex(l=>l.ProductId===s);a!==-1&&t>0?(e.BasketItems[a].Quantity=t,e.BasketItems[a].Total=e.BasketItems[a].Quantity*e.BasketItems[a].UnitPrice,e.totalAmount=this.calculateTotalAmount(e.BasketItems),this.updateLocalStorage(e)):t<=0&&this.removeItem(s)}removeItem(s){let t=this.getInitialBasket(),e=t.BasketItems.findIndex(a=>a.ProductId===s);e!==-1&&(t.BasketItems.splice(e,1),t.totalAmount=this.calculateTotalAmount(t.BasketItems),this.updateLocalStorage(t))}clearBasket(){localStorage.removeItem(this.basketKey),this.cartSubject.next(new o)}calculateTotalAmount(s){return s.reduce((t,e)=>t+e.Total,0)}getBasketItems(){return this.getInitialBasket().BasketItems}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();export{B as a};
