import{a as P}from"./chunk-IPLPXCIC.js";import{a as w}from"./chunk-H27N22TA.js";import{b as I,c as F}from"./chunk-TFHMV6T3.js";import{l as S}from"./chunk-FCALHRBG.js";import{Eb as v,Lc as y,Mc as b,Nb as h,Pb as x,Va as s,Wa as n,da as g,mb as f,ob as c,ub as a,vb as m,wb as u}from"./chunk-AWDU22X2.js";function C(r,o){if(r&1&&(a(0,"h1",5),h(1),m()),r&2){let d=v();s(),x(" ",d.category.name," products ")}}function j(r,o){if(r&1&&u(0,"app-card",6),r&2){let d=o.$implicit;c("product",d)}}var B=(()=>{let o=class o{constructor(e,t,i,l){this.route=e,this.productService=t,this.filterService=i,this.categoryService=l,this.Products=[]}ngOnInit(){this.route.params.subscribe(e=>{console.log("Category id",e.id);let t=e.id;this.categoryService.GetSingleCategory(t).subscribe(i=>{console.log("category",i),this.category=i.value}),this.applyFilter([t]),this.GetAllProducts(1)})}GetAllProducts(e){this.productService.GetAllProducts(e).subscribe(t=>{console.log("All products",t),this.Products=t.value.items,this.page=t.value,this.Products.forEach(i=>{this.productService.GetProductMasterImage(i.id).subscribe(l=>{this.createImageFromBlob(l).then(p=>{i.masterImage=p}).catch(p=>{console.error("Error converting image blob to base64",p)})})})})}createImageFromBlob(e){return new Promise((t,i)=>{let l=new FileReader;l.addEventListener("load",()=>{t(l.result)},!1),l.addEventListener("error",()=>{i(new Error("Failed to read the Blob as a Data URL."))},!1),e?l.readAsDataURL(e):i(new Error("No Blob provided."))})}GoToPage(e){this.GetAllProducts(e)}applyFilter(e){console.log("Selected Categories:",e);let t=this.filterService.filter.value;t.categoryIds=e,this.filterService.filter.next(t)}ngOnDestroy(){let e=this.filterService.filter.value;e.categoryIds=null,this.filterService.filter.next(e)}};o.\u0275fac=function(t){return new(t||o)(n(S),n(F),n(I),n(w))},o.\u0275cmp=g({type:o,selectors:[["app-product-list"]],decls:7,vars:2,consts:[[1,"w-full","flex","flex-col","justify-end","justify-items-end","content-start","align-end","items-start"],[1,"h-fit","pb-28","pt-10","ps-10","flex","flex-col","justify-content-end","align-content-end","align-items-end"],["class","text-2xl underline mt-2",4,"ngIf"],[1,"h-fit","w-fit","ps-10","flex","flex-col","justify-center","align-content-center","align-middle","items-center","gap-10","md:flex-row","lg:flex-row","xl:flex-row","xl:gap-5","xl:justify-start","xl:items-start","xl:align-top","xl:pt-0","xl:flex-wrap"],["class","h-[37rem] w-fit block",3,"product",4,"ngFor","ngForOf"],[1,"text-2xl","underline","mt-2"],[1,"h-[37rem]","w-fit","block",3,"product"]],template:function(t,i){t&1&&(u(0,"br")(1,"br"),a(2,"div",0)(3,"div",1),f(4,C,2,1,"h1",2),a(5,"div",3),f(6,j,1,1,"app-card",4),m()()()),t&2&&(s(4),c("ngIf",i.category),s(2),c("ngForOf",i.Products))},dependencies:[y,b,P]});let r=o;return r})();export{B as a};
